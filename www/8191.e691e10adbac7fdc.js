"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8191],{8191:(O,_,a)=>{a.r(_),a.d(_,{ShopKeeperPageModule:()=>T});var f=a(177),c=a(9417),r=a(9191),h=a(9025),g=a(467),d=a(3873),y=a(7366),M=a(7177),b=a(6443),C=a(872),e=a(4438),v=a(8312);function k(s,l){if(1&s&&(e.j41(0,"ion-select-option"),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.R7$(),e.JRh(t.name)}}function x(s,l){if(1&s){const t=e.RV6();e.j41(0,"ion-select",22),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG(2);return e.DH7(o.selectedUser.name,n)||(o.selectedUser.name=n),e.Njj(n)}),e.DNE(1,k,2,1,"ion-select-option",21),e.k0s()}if(2&s){const t=e.XpG(2);e.R50("ngModel",t.selectedUser.name),e.R7$(),e.Y8G("ngForOf",t.department.services)}}function S(s,l){if(1&s){const t=e.RV6();e.j41(0,"ion-input",23),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG(2);return e.DH7(o.selectedUser.name,n)||(o.selectedUser.name=n),e.Njj(n)}),e.k0s()}if(2&s){const t=e.XpG(2);e.R50("ngModel",t.selectedUser.name)}}function j(s,l){if(1&s&&(e.j41(0,"ion-select-option",26),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t.formattedAddress)}}function U(s,l){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-label",12),e.EFF(2,"Location"),e.j41(3,"ion-text",13),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ion-select",24),e.bIt("ionChange",function(n){e.eBV(t);const o=e.XpG(2);return e.Njj(o.onLocationChange(n))}),e.DNE(6,j,2,2,"ion-select-option",25),e.k0s()()}if(2&s){const t=e.XpG(2);e.R7$(5),e.Y8G("selectedText",null==t.selectedLocation?null:t.selectedLocation.formattedAddress),e.R7$(),e.Y8G("ngForOf",t.locations)}}function F(s,l){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"ion-row")(2,"ion-col")(3,"ion-item",27)(4,"ion-label"),e.EFF(5,"Open Time"),e.k0s(),e.j41(6,"ion-datetime",30),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG().$implicit;return e.DH7(o.startTime,n)||(o.startTime=n),e.Njj(n)}),e.k0s()()(),e.j41(7,"ion-col")(8,"ion-item",27)(9,"ion-label"),e.EFF(10,"Close Time"),e.k0s(),e.j41(11,"ion-datetime",30),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG().$implicit;return e.DH7(o.endTime,n)||(o.endTime=n),e.Njj(n)}),e.k0s()()()(),e.j41(12,"ion-row")(13,"ion-col")(14,"ion-item")(15,"ion-label",12),e.EFF(16,"Slot Duration"),e.j41(17,"ion-text",13),e.EFF(18,"*"),e.k0s()(),e.j41(19,"ion-input",31),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG().$implicit;return e.DH7(o.durationInMin,n)||(o.durationInMin=n),e.Njj(n)}),e.k0s()()(),e.j41(20,"ion-col")(21,"ion-item")(22,"ion-label",12),e.EFF(23,"Customers Per Slot"),e.j41(24,"ion-text",13),e.EFF(25,"*"),e.k0s()(),e.j41(26,"ion-input",31),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG().$implicit;return e.DH7(o.slotLimit,n)||(o.slotLimit=n),e.Njj(n)}),e.k0s()()()(),e.bVm()}if(2&s){const t=e.XpG(),i=t.$implicit,n=t.index;e.R7$(6),e.R50("ngModel",i.startTime),e.Y8G("name","opnTime"+n),e.R7$(5),e.R50("ngModel",i.endTime),e.Y8G("name","closeTime"+n),e.R7$(8),e.R50("ngModel",i.durationInMin),e.Y8G("value",i.durationInMin)("name","slotDuration"+n),e.R7$(7),e.R50("ngModel",i.slotLimit),e.Y8G("value",i.slotLimit)("name","CustomersSlot"+n)}}function P(s,l){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-item",27)(5,"p",28),e.EFF(6),e.nI1(7,"trimunit"),e.k0s(),e.j41(8,"ion-toggle",29),e.mxI("ngModelChange",function(n){const o=e.eBV(t).$implicit;return e.DH7(o.checked,n)||(o.checked=n),e.Njj(n)}),e.k0s()()()(),e.DNE(9,F,27,10,"ng-container",3),e.k0s()()}if(2&s){const t=l.$implicit,i=l.index;e.R7$(6),e.JRh(t.day?e.i5U(7,4,t.day,3):"-"),e.R7$(2),e.R50("ngModel",t.checked),e.Y8G("name",i+"checked"),e.R7$(),e.Y8G("ngIf",t.checked)}}function D(s,l){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"ion-grid",7)(2,"ion-row")(3,"ion-label",8),e.EFF(4,"Fill below details to complete your setup"),e.k0s()()(),e.j41(5,"ion-grid",9)(6,"ion-row",10)(7,"ion-col",11)(8,"ion-item")(9,"ion-label",12),e.EFF(10),e.j41(11,"ion-text",13),e.EFF(12,"*"),e.k0s()(),e.DNE(13,x,2,2,"ion-select",14)(14,S,1,1,"ion-input",15),e.k0s(),e.j41(15,"ion-item")(16,"ion-label",12),e.EFF(17,"Description"),e.j41(18,"ion-text",13),e.EFF(19,"*"),e.k0s()(),e.j41(20,"ion-textarea",16),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG();return e.DH7(o.selectedUser.description,n)||(o.selectedUser.description=n),e.Njj(n)}),e.k0s()(),e.j41(21,"ion-item")(22,"ion-label",17),e.EFF(23,"Mobile Number "),e.j41(24,"ion-text",13),e.EFF(25,"*"),e.k0s()(),e.j41(26,"ion-text"),e.EFF(27),e.nI1(28,"parseNumber"),e.k0s()(),e.j41(29,"ion-item")(30,"ion-label",12),e.EFF(31),e.k0s(),e.j41(32,"ion-textarea",18),e.mxI("ngModelChange",function(n){e.eBV(t);const o=e.XpG();return e.DH7(o.selectedUser.formattedAddress,n)||(o.selectedUser.formattedAddress=n),e.Njj(n)}),e.k0s()(),e.DNE(33,U,7,2,"ion-item",3),e.k0s(),e.nrm(34,"ion-col",19),e.j41(35,"ion-col",20),e.DNE(36,P,10,7,"ion-item",21),e.k0s()()(),e.bVm()}if(2&s){const t=e.XpG();e.R7$(10),e.SpI("",t.vendorDeatil?t.vendorDeatil.serviceLabel:"Shop"," Name "),e.R7$(3),e.Y8G("ngIf",t.vendorDeatil.conceirge&&t.department),e.R7$(),e.Y8G("ngIf",!t.vendorDeatil.conceirge),e.R7$(6),e.R50("ngModel",t.selectedUser.description),e.R7$(7),e.JRh(e.bMT(28,9,t.selectedUser.phonenumber)),e.R7$(4),e.JRh(t.vendorDeatil.addressLabel?t.vendorDeatil.addressLabel:"Address"),e.R7$(),e.R50("ngModel",t.selectedUser.formattedAddress),e.R7$(),e.Y8G("ngIf",t.vendorDeatil.updateShopLocation),e.R7$(3),e.Y8G("ngForOf",t.selectedUser.availableDays)}}let u=(()=>{class s{constructor(t,i,n,o,p,m){this.appService=t,this.router=i,this.modalCtrl=n,this.activatedRoute=o,this.utilAlertService=p,this.loadingController=m,this.daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.addressList=[],this.locations=[],this.firstTime=!0,this.departments=[],this.user=new d.ep,this.selectedUser=new d.ep,this.getUserDetail(),this.getVendorDetail()}ngOnInit(){}ionViewWillEnter(){this.activatedRoute.params.subscribe(t=>{t&&(this.storeId=t.id),this.selectedAddress=void 0,this.addressList=[],this.getLocations(),this.user=JSON.parse(localStorage.getItem("user")),this.getAllServices(),this.user||(this.user=new d.ep),this.setAvailableDays()})}getCategory(){this.appService.getCategory().subscribe(t=>{t&&t.body&&t.body.length&&(this.categories=t.body)})}getAllServices(){this.department=this.departments.find(t=>{if(t&&t.name===this.user.name)return t})}onServiceChange(t){}onLocationChange(t){t&&t.detail&&t.detail.value&&(this.selectedLocation=t.detail.value)}getLocations(){this.appService.getCity().subscribe(t=>{t&&t.body&&t.body.length&&(this.locations=t.body,this.selectedUser&&this.locations&&this.locations.length&&(this.selectedLocation=this.locations.find(i=>i.locationId===this.selectedUser.locationId)))})}setAdminAvailableDays(){this.selectedUser=this.user,this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const i=new d.TA;i.day=t;const n=this.selectedUser.availableDays.findIndex(o=>o.day===i.day);-1===n?this.selectedUser.availableDays.push(i):this.selectedUser.availableDays[n].checked=!0})}setAvailableDays(){this.storeId?(this.selectedUser=this.user.shops.find(t=>t.phonenumber===this.storeId),this.selectedUser&&(this.selectedUser.formattedAddress&&(this.selectedAddress={lng:this.selectedUser.lng,lat:this.selectedUser.lat,photoReference:this.selectedUser.photoReference,formattedAddress:this.selectedUser.formattedAddress}),this.daysInWeek.forEach(t=>{const i=new d.TA;i.day=t;const n=this.selectedUser.availableDays.findIndex(o=>o.day===i.day);-1===n?this.selectedUser.availableDays.push(i):this.selectedUser.availableDays[n].checked=!0}))):this.setAdminAvailableDays()}checkIfSlotschecked(){let t=!1;if(this.selectedUser&&this.selectedUser.availableDays)for(const i of this.selectedUser.availableDays)if(i.checked){t=!0;break}return t}successModal(){var t=this;return(0,g.A)(function*(i=""){return yield(yield t.modalCtrl.create({cssClass:"login-modal-page",animated:!0,showBackdrop:!0,component:M.h,componentProps:{type:t.selectedUser.type,msg:i}})).present()}).apply(this,arguments)}dismiss(){var t=this;return(0,g.A)(function*(){yield t.modalCtrl.dismiss()})()}convertDetailBeforeSave(){return this.selectedUser.availableDays.filter(t=>t.checked)}save(){var t=this;return(0,g.A)(function*(){let i=!0;if(!t.selectedUser.name)return i=!1,void t.utilAlertService.showAlert("Please Enter Name");if(!t.selectedUser.phonenumber)return i=!1,void t.utilAlertService.showAlert("Please Enter Phone Number");if(t.vendorDeatil.updateShopLocation&&!t.selectedLocation)return i=!1,void t.utilAlertService.showAlert("Please select Location");if(!t.checkIfSlotschecked())return i=!1,void t.utilAlertService.showAlert("Please select the slots");if(i&&t.selectedUser){t.selectedUser.availableDays=t.convertDetailBeforeSave(),t.selectedLocation&&(t.selectedUser.locationId=t.selectedLocation.locationId),t.selectedUser.idCategory=t.vendorDeatil.idCategory;const n=yield t.loadingController.create({message:"Loading..."});yield n.present(),t.appService.createStore(t.selectedUser).subscribe(o=>{if(n.dismiss(),o&&o.body){if("A"===t.user.type){const p=t.user.shops.findIndex(m=>m.userId===o.body.userId);-1!==p&&(t.user.shops[p]=o.body)}else t.user=o.body;t.successModal(),setTimeout(()=>{t.dismiss(),t.appService.setUserDetail(t.user),localStorage.setItem("user",JSON.stringify(t.user)),t.selectedUser=new d.ep,t.router.navigate("A"===t.user.type?["/user-shops"]:["/booked-customers"])},2e3)}},()=>{n.dismiss()})}})()}getUserDetail(){this.appService.userDetail.subscribe(t=>{this.user=t})}getVendorDetail(){this.appService.vendorDeatil.subscribe(t=>{t&&(this.vendorDeatil=t,this.departments=this.vendorDeatil.departments)})}searchAddress(t){this.selectedAddress=void 0;const i=t.target.value;this.addressList=[],i&&this.appService.searchShopAddress({query:i}).subscribe(o=>{console.log(o),o&&o.body&&(this.addressList=o.body)})}selectAddress(t){this.selectedAddress=t,this.addressList=[]}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(y.d),e.rXU(h.Ix),e.rXU(r.W3),e.rXU(h.nX),e.rXU(v.e),e.rXU(r.Xi))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-shop-keeper"]],standalone:!0,features:[e.aNF],decls:9,vars:1,consts:[["shopForm","ngForm"],[1,"container"],["name","form1",1,"shop-form"],[4,"ngIf"],[1,"shop-keeper-btn-container"],["name","submit","size","default","expand","primary","tappable","",1,"book-appointment-btn",3,"click"],[1,"mr-1"],[2,"margin","8pt 16pt"],[2,"font-size","12pt"],[1,"shop-keeper-grid"],[1,"shop-keeper-row"],[1,"shop-keeper-col","shop-keeper-detail"],["position","stacked"],["color","danger"],["name","firstname","interface","action-sheet",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","name","shopName","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","desc","required","",3,"ngModelChange","ngModel"],["position","stacked",2,"opacity","1"],["name","address",3,"ngModelChange","ngModel"],["size","auto",1,"v-divider","ion-no-padding"],[1,"shop-keeper-col","shop-keeper-slot-detail"],[4,"ngFor","ngForOf"],["name","firstname","interface","action-sheet",3,"ngModelChange","ngModel"],["type","text","name","shopName","required","",3,"ngModelChange","ngModel"],["interface","action-sheet",3,"ionChange","selectedText"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["lines","none"],[2,"width","25%"],[3,"ngModelChange","ngModel","name"],["display-format","hh:mm A","placeholder","hh:mm a","picker-format","hh:mm a","required","",3,"ngModelChange","ngModel","name"],["type","text","required","",3,"ngModelChange","ngModel","value","name"]],template:function(i,n){if(1&i){const o=e.RV6();e.j41(0,"ion-content")(1,"div",1)(2,"form",2,0),e.DNE(4,D,37,11,"ng-container",3),e.k0s(),e.j41(5,"div",4)(6,"ion-button",5),e.bIt("click",function(){return e.eBV(o),e.Njj(n.save())}),e.j41(7,"span",6),e.EFF(8,"Save"),e.k0s()()()()()}2&i&&(e.R7$(4),e.Y8G("ngIf",n.user))},dependencies:[C.B,r.bv,r.Jm,r.hU,r.W9,r.A9,r.lO,r.$w,r.uz,r.he,r.ln,r.Nm,r.Ip,r.IO,r.nc,r.BY,r.hB,r.Je,r.Gw,b.h,c.YN,c.qT,c.BC,c.cb,c.YS,c.vS,c.cV],styles:[".shop-form[_ngcontent-%COMP%]{height:calc(100% - 50px);overflow-y:auto}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]{display:grid;grid-column-gap:10px;grid-row-gap:9px}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{display:block}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .shop-address-search[_ngcontent-%COMP%]   .searchbar-input-container.sc-ion-searchbar-md[_ngcontent-%COMP%]{--box-shadow: none !important;border-bottom:1px solid rgba(84,80,80,.25)!important}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .shop-keeper-row[_ngcontent-%COMP%]   .v-divider[_ngcontent-%COMP%]{width:1px!important;padding:0;font-size:1px;flex:none;max-width:1px!important;border-right:1px solid #dcdcdc}.shop-form[_ngcontent-%COMP%]   .shop-keeper-grid[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{font-size:12pt!important}.shop-keeper-btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:4pt 16pt;position:fixed;width:100%;left:0;bottom:0;height:50px;z-index:1;margin:0}.native-input[disabled][_ngcontent-%COMP%]{opacity:1!important}"]})}}return s})();const I=[{path:"",component:u}];let R=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[h.iI.forChild(I),h.iI]})}}return s})();var A=a(5553);let T=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[f.MD,c.YN,r.bv,A.h,R,u]})}}return s})()}}]);